(function(){var n,t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(t){var e=new t,o={},i=1,u=[],r={},a=e.createGain(),f=e.createDynamicsCompressor();f.connect(a),a.connect(e.destination),a.gain.value=1;var s=f,c=!1,l=1,p=function(n){var t=new Float32Array(0),i=!1,u=[];o[n]=this,function(){var o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=function(){e.decodeAudioData(o.response,function(n){t=n,i=!0;for(var e=0,o=u.length;e<o;e++){var r=u[e];"function"==typeof r&&r()}},function(){i=!0;for(var n=0,t=u.length;n<t;n++){var e=u[n];"function"==typeof e&&e()}})}.bind(this),o.send()}.bind(this)(),this.onload=function(n){i?n():u.push(n)},this.getBuffer=function(){return t}},d=function(n,t,a){var f=function(){r[d]&&(u.push(d),delete r[d])};if(this.play=function(){f()},this.pause=function(){},this.stop=function(){},!c||a){var l=null,p=o[n];if(p&&(l=p.getBuffer()),l){var d;d=u.length?u.shift():i++,r[d]=this;var h,y=0,v=0,g=!1,w=function(){var n=e.createBufferSource();return n.buffer=l,n.connect(s),n.onended=function(){g||f()},a&&(n.loop=!0,n.loopStart=t,n.loopEnd=a),n};this.play=function(){return g=!1,h=w(),y=e.currentTime-v,console.log("startTime: "+y),console.log("playedTime: "+v),h.start?h.start(0,v):h.noteGrainOn?h.noteGrainOn(0,v):h.noteOn(0,v),d},this.pause=function(){v=e.currentTime-y,console.log("playedTime: "+v),g=!0,h&&h.stop()},this.stop=function(){g=!1,h&&h.stop()}}}};n={support:function(){return!0},load:function(n,t){n instanceof Array||(n=[n]);var e,o,i=n.length,u=0;for(e=0;e<i;e++)o=new p(n[e]),o.onload(function(){++u>=i&&"function"==typeof t&&t()})},unload:function(n){n instanceof Array||(n=[n]);var t,e=n.length;for(t=0;t<e;t++)o[n[t]]&&delete o[n[t]]},play:function(n,t,e){return new d(n,t,e).play()},pause:function(n){r[n]&&r[n].pause()},resume:function(n){r[n]&&r[n].play()},stop:function(n){r[n]&&r[n].stop()},setVolume:function(n){c||(a.gain.value=n),l=n},getVolume:function(){return l},setMuted:function(n){c=n,a.gain.value=n?0:l},getMuted:function(){return c},pauseAll:function(){for(var n in r)r.hasOwnProperty(n)&&r[n].pause&&r[n].pause()},stopAll:function(){for(var n in r)r.hasOwnProperty(n)&&r[n].stop&&r[n].stop()}}}else{var h=function(){};n={support:function(){return!1},load:h,unload:h,play:h,pause:h,stop:h,setVolume:h,setMuted:h,getMuted:function(){return!0},pauseAll:h,stopAll:h}}"undefined"!=typeof module&&"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):this.benzAudioEngine=n}).call(this||("undefined"!=typeof window?window:global));