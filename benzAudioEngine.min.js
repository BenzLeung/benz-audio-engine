(function(){var n,t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(t){var e=new t,o={},u=1,i=[],r={},f=e.createGain(),a=e.createDynamicsCompressor();a.connect(f),f.connect(e.destination),f.gain.value=1;var s=a,c=!1,p=1,l=function(n){var t=new Float32Array(0),u=!1,i=[];o[n]=this,function(){var o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=function(){e.decodeAudioData(o.response,function(n){t=n,u=!0;for(var e=0,o=i.length;e<o;e++){var r=i[e];"function"==typeof r&&r()}},function(){u=!0;for(var n=0,t=i.length;n<t;n++){var e=i[n];"function"==typeof e&&e()}})}.bind(this),o.send()}.bind(this)(),this.onload=function(n){u?n():i.push(n)},this.getBuffer=function(){return t}},d=function(n,t,f){var a=function(){r[d]&&(i.push(d),delete r[d])};if(this.play=function(){a()},this.pause=function(){},this.stop=function(){},!c||f){var p=null,l=o[n];if(l&&(p=l.getBuffer()),p){var d;d=i.length?i.shift():u++,r[d]=this;var h,v=0,y=0,w=!0,g=function(){var n=e.createBufferSource();return n.buffer=p,n.connect(s),n.onended=function(){w||a()},f&&(n.loop=!0,n.loopStart=t,n.loopEnd=f),n};this.play=function(){return h&&!w?d:(w=!1,h=g(),v=e.currentTime-y,h.start?h.start(0,y):h.noteGrainOn?h.noteGrainOn(0,y):h.noteOn(0,y),d)},this.pause=function(){y=e.currentTime-v,w=!0,h&&h.stop()},this.stop=function(){w=!1,h&&h.stop(),a()}}}};n={support:function(){return!0},load:function(n,t){n instanceof Array||(n=[n]);var e,o,u=n.length,i=0;for(e=0;e<u;e++)o=new l(n[e]),o.onload(function(){++i>=u&&"function"==typeof t&&t()})},unload:function(n){n instanceof Array||(n=[n]);var t,e=n.length;for(t=0;t<e;t++)o[n[t]]&&delete o[n[t]]},play:function(n,t,e){return new d(n,t,e).play()},pause:function(n){r[n]&&r[n].pause()},resume:function(n){r[n]&&r[n].play()},stop:function(n){r[n]&&r[n].stop()},setVolume:function(n){c||(f.gain.value=n),p=n},getVolume:function(){return p},setMuted:function(n){c=n,f.gain.value=n?0:p},getMuted:function(){return c},pauseAll:function(){for(var n in r)r.hasOwnProperty(n)&&r[n].pause&&r[n].pause()},stopAll:function(){for(var n in r)r.hasOwnProperty(n)&&r[n].stop&&r[n].stop()}}}else{var h=function(){};n={support:function(){return!1},load:h,unload:h,play:h,pause:h,stop:h,setVolume:h,setMuted:h,getMuted:function(){return!0},pauseAll:h,stopAll:h}}"undefined"!=typeof module&&"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):this.benzAudioEngine=n}).call(this||("undefined"!=typeof window?window:global));